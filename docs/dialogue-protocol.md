# Протокол диалога Claude ↔ Gemini

Подробное описание механизмов P2P диалога между AI моделями.

## Бюджет прогресса

Вместо жёсткого лимита раундов используется динамический бюджет:

- **Начальное значение:** 5
- **Нет прогресса:** бюджет -1
- **Есть прогресс:** бюджет восстанавливается до 5
- **Бюджет = 0:** эскалация к пользователю

**Что считается прогрессом:**
- Создан/изменён артефакт (код, план, схема)
- Получена новая информация через инструмент
- Формальное принятие аргумента: "Принимаю твой подход к [X]"

## Правило честного диалога

**Цель диалога — лучшее решение, а не победа в споре.**

- При возражении — явно признать сильные аргументы оппонента
- Формат: "Согласен с [X], но не согласен с [Y] потому что..."
- **Красный флаг:** 3 раунда только возражений → самопроверка: "Я защищаю позицию или ищу истину?"
- Если самопроверка не помогла → эскалация к пользователю

## Правило синтеза

При **расхождении позиций** — обязательный шаг синтеза.

**Триггеры для синтеза:**
- **Явное несогласие** — маркеры: "не согласен", "против", "лучше сделать", "предлагаю альтернативу"
- **Конкурирующие предложения** — оба предлагают разные решения одной задачи
- **Игнорирование + контрпредложение** — нет сигнала принятия, но есть альтернатива

**НЕ триггеры (синтез не нужен):**
- Уточняющий вопрос
- Дополняющее предложение
- Последовательные шаги

**Цель синтеза:** объединить лучшее из обоих подходов или предложить третий вариант.

**Лимит:** если 2 попытки синтеза провалились → эскалация.

## Проверка гипотез

При спорах о фактах — использовать инструменты для проверки:

**Формат:** "Моя гипотеза — [X]. Проверяю через [инструмент]."

**Примеры:**
- Спор об архитектуре → проверить код
- Спор о формулировке → поискать в документации
- Спор о возможностях → тестовый запрос

## Эскалация к пользователю

**Триггеры эскалации:**
- Бюджет прогресса = 0
- 2 провалившихся попытки синтеза
- Вопрос требует решения пользователя (предпочтения, бизнес-логика)

**Формат эскалации:**
1. Исходная цель
2. Позиция Claude
3. Позиция Gemini
4. Точка разногласия

## Отчёт пользователю

После завершения диалога предоставляется:

- **Количество раундов** диалога
- Краткий итог дискуссии
- **Что Claude пересмотрел/принял** от Gemini
- Финальное решение/консенсус
- Если была эскалация — изложение обеих позиций для решения пользователя
